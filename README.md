## 软件界面

![17469400608191746940059974.png](https://fastly.jsdelivr.net/gh/Achuan-2/PicBed@pic/assets/17469400608191746940059974.png)

## 主要功能

- **数据加载**：支持从 .mat 文件或 Excel 文件加载钙信号数据
- **灵活的基线计算**：提供多种基线 F0 计算方法

  - **百分位数法**：使用指定百分位数作为基线
  - **多项式拟合法**：使用多项式拟合数据趋势作为基线
  - **移动百分位数法**：在移动窗口内计算百分位数作为基线
- **可视化工具**：

  - 单神经元 ΔF/F 轨迹可视化
  - 所有神经元 ΔF/F 热图显示
  - 自定义刻度条和颜色映射
- **结果导出**：将处理后的数据保存为 .mat 和 .xlsx 文件格式

## 使用方法

### 数据加载

1. 启动应用程序
2. 设置数据帧率（Hz）
3. 点击"Load Data"按钮选择数据文件

    - 支持 .mat 文件（包含荧光数据矩阵，行为神经元，列为帧）
    - 支持 .xlsx/.xls 文件（同样格式）

### 基线参数设置

根据实验需求选择合适的基线计算方法：

- **百分位数法**：

  - 设置百分位数值（如"10-20"表示10%-20%的平均值，或单一值如"20"）
  - 可选择指定基线计算的时间范围
- **多项式拟合法**：

  - 设置多项式阶数
- **移动百分位数法**：

  - 设置移动窗口大小（秒）
  - 设置百分位数值

### 数据分析与可视化

1. 设置好参数后点击"Run Analysis"按钮计算 ΔF/F
2. 使用神经元下拉菜单或前进/后退按钮在不同神经元间切换
3. 点击"Display All Neurons"查看所有神经元的热图显示
4. 可以调整显示参数如信号刻度、时间刻度、颜色映射等

### 结果保存

点击"Save Results"按钮将计算结果保存为：

- .mat 文件（包含原始数据、ΔF/F数据及计算参数）
- .xlsx 文件（包含原始数据和ΔF/F数据）

## 软件输出

### mat文件输出

1. **analysis_date**：分析日期，记录数据进行分析的具体时间。
2. **raw_sig**：原始信号，存储未经处理或初步处理的原始数据信号
3. **dff_sig**：计算的ΔF/F数据。
4. **baseline_method**：基线方法，表明用于确定数据基线所采用的方法。
5. **framerate**：数据采集时每秒的帧率。
6. **moving_percentile**：移动百分位数。
7. **moving_window_sec**：移动窗口时长 。
8. **percentile_value**：百分位数值。
9. **polynomial_order**：多项式阶数，当使用多项式方法（如确定基线时），该值表示多项式的阶数。
10. **time_vector**：时间向量，存储与信号数据对应的时间信息

![17469402961791746940296122.png](https://fastly.jsdelivr.net/gh/Achuan-2/PicBed@pic/assets/17469402961791746940296122.png)

### excel

保存excel，sheet1是dff_sig，sheet_2是raw_sig

![17469403681171746940367329.png](https://fastly.jsdelivr.net/gh/Achuan-2/PicBed@pic/assets/17469403681171746940367329.png)

### 绘图

- 绘制单个神经元的ΔF/F

  ![17469403051231746940304531.png](https://fastly.jsdelivr.net/gh/Achuan-2/PicBed@pic/assets/17469403051231746940304531.png)
- 绘制多个神经元的ΔF/F

  ![17469403123481746940311674.png](https://fastly.jsdelivr.net/gh/Achuan-2/PicBed@pic/assets/17469403123481746940311674.png)